<?xml version="1.0" encoding="UTF-8" ?>
<launch>
    <arg name="robot" default="X1"/>
    <arg name="world_name" default="simple_cave_02"/>
    <arg name="gt_mesh_file" default="$(find rpz_planning)/data/meshes/$(arg world_name).obj"/>
    <arg name="rviz" default="true"/>
    <arg name="do_eval" default="true"/>
    <arg name="eval_rate" default="0.05"/> <!-- how often do mapping evaluation -->
    <arg name="bag" default="$(find rpz_planning)/data/bags/explorer_x1_opt_path_false_simple_cave_02_2021-05-28-19-14-29.bag"/>
    <arg name="bag_rate" default="1.0"/>

    <param name="use_sim_time" value="true" />

    <!-- Map accumulator node -->
    <include file="$(find rpz_planning)/launch/map_accumulator.launch" pass_all_args="true">
        <arg name="bag" value="$(arg bag)"/>
        <arg name="rate" value="$(arg bag_rate)"/>
    </include>

    <!-- Mapping evaluation -->
    <node ns="$(arg robot)" name="map_eval" pkg="rpz_planning" type="map_eval.py" output="screen">
        <rosparam subst_value="true">
            map_topic: map_accumulator/map
            gt_mesh: $(arg gt_mesh_file)
            normalize_mesh_pcl: False
            do_points_sampling: False
            do_eval: $(arg do_eval)
            n_sample_points: 10000
            max_age: 5.0
            map_frame: $(arg world_name)
<!--            map_frame: subt-->
            eval_rate: $(arg eval_rate)
        </rosparam>
    </node>

    <!-- RVIZ -->
    <node if="$(arg rviz)" name="rviz" pkg="rviz" type="rviz"
          args="-d $(dirname)/../rviz/map_accum.rviz"/>
</launch>
