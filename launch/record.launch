<?xml version="1.0" encoding="UTF-8" ?>
<launch>
    <arg name="robot" default="X1"/>
    <arg name="robot_type" default="explorer_x1"/>

    <!-- Map construction topics: new points and localization in tfs -->
    <arg name="mapping_topics" value="/$(arg robot)/updated_map
                                      /$(arg robot)/reward_cloud
                                      /$(arg robot)/$(arg path)
                                      /tf
                                      /tf_static"/>

    <!-- Images and cameras info for explorer_x1 and Lidar point cloud for detections localization -->
    <arg if="$(eval 'explorer_x1' in robot_type.lower())"
         name="detector_input_topics" value="/$(arg robot)/front_rgbd/optical/image_raw
                                             /$(arg robot)/front_rgbd/optical/camera_info
                                             /$(arg robot)/left_rgbd/optical/image_raw
                                             /$(arg robot)/left_rgbd/optical/camera_info
                                             /$(arg robot)/right_rgbd/optical/image_raw
                                             /$(arg robot)/right_rgbd/optical/camera_info
                                             /$(arg robot)/rear_rgbd/optical/image_raw
                                             /$(arg robot)/rear_rgbd/optical/camera_info
                                             /$(arg robot)/points_slow_filtered"/>

    <arg if="$(eval 'marv' in robot_type.lower())"
         name="detector_input_topics" value="/$(arg robot)/front/image_raw
                                             /$(arg robot)/front/camera_info
                                             /$(arg robot)/omni/camera_0/image_raw
                                             /$(arg robot)/omni/camera_0/optical/camera_info
                                             /$(arg robot)/omni/camera_1/image_raw
                                             /$(arg robot)/omni/camera_1/optical/camera_info
                                             /$(arg robot)/omni/camera_2/image_raw
                                             /$(arg robot)/omni/camera_2/optical/camera_info
                                             /$(arg robot)/omni/camera_3/image_raw
                                             /$(arg robot)/omni/camera_3/optical/camera_info
                                             /$(arg robot)/omni/camera_4/image_raw
                                             /$(arg robot)/omni/camera_4/optical/camera_info
                                             /$(arg robot)/rear/image_raw
                                             /$(arg robot)/rear/camera_info
                                             /$(arg robot)/points_slow_filtered"/>

    <!-- Inputs for trajectory optimization -->
    <arg if="$(eval 'explorer_x1' in robot_type.lower())" name="trajopt_input_topics"
         value="/$(arg robot)/front_rgbd/optical/camera_info
                /$(arg robot)/left_rgbd/optical/camera_info
                /$(arg robot)/rear_rgbd/optical/camera_info
                /$(arg robot)/right_rgbd/optical/camera_info
                /$(arg robot)/local_map_slow
                /$(arg robot)/path
                /tf
                /tf_static
                /$(arg robot)/traversability"/>

    <arg if="$(eval 'marv' in robot_type.lower())" name="trajopt_input_topics"
         value="/$(arg robot)/front/optical/camera_info
                /$(arg robot)/omni/camera_0/optical/camera_info
                /$(arg robot)/omni/camera_1/optical/camera_info
                /$(arg robot)/omni/camera_2/optical/camera_info
                /$(arg robot)/omni/camera_3/optical/camera_info
                /$(arg robot)/omni/camera_4/optical/camera_info
                /$(arg robot)/rear/optical/camera_info
                /$(arg robot)/local_map_slow
                /$(arg robot)/path
                /tf
                /tf_static
                /$(arg robot)/traversability"/>

    <!-- Detection localization hypothesis -->
    <arg name="detections_localization_topics"
         value="/$(arg robot)/detection_localization/dbg_confirmed_hypotheses_pcl
                /$(arg robot)/detection_localization/dbg_confirmed_hypotheses_pcl
                /$(arg robot)/detection_localization/dbg_hypotheses_pcl
                /$(arg robot)/detection_localization/dbg_measurements_pcl"/>

    <!-- Recorder node: input topics are specified here as input arguments -->
    <node name="record_data" pkg="rosbag" type="record"
          args="-o $(find rpz_planning)/$(arg robot_type)_opt_path_$(arg follow_opt_path)
                $(arg mapping_topics) $(arg detector_input_topics)
                --duration $(arg record_duration)"/>
</launch>
